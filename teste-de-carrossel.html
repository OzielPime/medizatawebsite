<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrossel de Produtos</title>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css">
    <style>
        /* Estilo personalizado para os dots do carrossel */
        .slick-dots {
            display: flex; /* Faz os dots ficarem em linha */
            flex-wrap: wrap; /* Faz os dots irem para a linha de baixo quando não couberem na linha atual */
            justify-content: center; /* Centraliza os dots horizontalmente */
            align-items: center; /* Centraliza os dots verticalmente */
        }

            .slick-dots li {
                margin: 0 5px; /* Espaçamento entre os dots */
                list-style: none; /* Remove os marcadores padrão da lista */
            }

                .slick-dots li button {
                    font-size: 10px; /* Tamanho da fonte dos dots */
                    line-height: 10px; /* Altura da linha para centralizar o dot verticalmente */
                    width: 10px; /* Largura do dot */
                    height: 10px; /* Altura do dot */
                    border: 1px solid #bbb; /* Borda do dot */
                    background-color: transparent; /* Fundo transparente do dot */
                    border-radius: 50%; /* Deixa o dot arredondado */
                    cursor: pointer; /* Altera o cursor ao passar por cima do dot */
                    transition: background-color 0.3s ease; /* Transição suave da cor de fundo do dot */
                }

                .slick-dots li.slick-active button {
                    background-color: #bbb; /* Cor de fundo do dot ativo */
                }
    </style>
</head>
<body>

    <!-- Carrossel de imagens -->
    <div class="carrossel-container">
        <div class="carrossel" id="carrossel">
        </div>
    </div>

    <!-- Adicione a biblioteca jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Adicione o link para o JavaScript do Slick Carousel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>

    <script>
        // Função para carregar o carrossel com base nos dados do arquivo de texto
        async function loadCarrossel() {
            // Localização do arquivo de texto
            const produtosTxt = "produtos.txt";

            // Obtém o elemento do carrossel
            const carrossel = document.getElementById("carrossel");

            try {
                // Faz uma requisição HTTP para o arquivo de texto
                const response = await fetch(produtosTxt);
                const data = await response.text();
                // Divide o conteúdo do arquivo em linhas
                const linhas = data.trim().split("\n");

                // Loop pelas linhas e cria os slides do carrossel
                for (const linha of linhas) {
                    const pastaCDP = linha.trim();

                    // Lê o arquivo "info.txt" dentro da pasta do produto
                    const infoTxtUrl = `Produtos/${pastaCDP}/info.txt`;
                    try {
                        const response = await fetch(infoTxtUrl);
                        const infoData = await response.text();
                        const [nomeProduto, preco] = infoData.trim().split("\n");

                        // Cria o slide (imagem + preço)
                        const slide = document.createElement("div");
                        slide.innerHTML = `
                        <a href="p.html?cdp=${pastaCDP}">
                            <img src="Produtos/${pastaCDP}/thumb.png" />
                        </a>
                        <p class="preco"> ${preco} R$ ${nomeProduto} </p>
                            `;

                        // Adiciona o slide ao carrossel
                        carrossel.appendChild(slide);
                    } catch (error) {
                        console.error(`Erro ao carregar informações do arquivo "${infoTxtUrl}":`, error);
                    }
                }

                // Inicializa o carrossel
                $('.carrossel').slick({
                    dots: true,
                    arrows: true,
                    infinite: true,
                    speed: 500,
                    slidesToShow: 3,
                    slidesToScroll: 1
                });

                // Adiciona o ouvinte de clique em cada imagem do carrossel
                const carrosselImages = document.querySelectorAll('.carrossel img');
                carrosselImages.forEach(image => {
                    image.addEventListener('click', () => {
                        const href = image.getAttribute('data-href');
                        if (href) {
                            window.location.href = href; // Redireciona para a página definida no atributo data-href
                        }
                    });
                });
            } catch (error) {
                console.error("Erro ao carregar o arquivo de produtos.", error);
            }
        }

        // Carrega o carrossel quando a página estiver pronta
        document.addEventListener("DOMContentLoaded", loadCarrossel);
    </script>


</body>
</html>
